<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>THEMIS & ARTEMIS Mission Visualization</title>
  <style>
    body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; }
    #info { position: absolute; top: 10px; left: 10px; color: white; background: rgba(0, 0, 0, 0.7); padding: 10px; border-radius: 5px; }
    #timeline { position: absolute; bottom: 20px; width: 80%; left: 10%; }
    #data-panel { position: absolute; top: 10px; right: 10px; color: white; background: rgba(0, 0, 0, 0.7); padding: 10px; border-radius: 5px; width: 300px; }
    #hso-panel { position: absolute; bottom: 60px; right: 10px; color: white; background: rgba(0, 0, 0, 0.7); padding: 10px; border-radius: 5px; width: 300px; }
    #events-panel { position: absolute; bottom: 60px; left: 10px; color: white; background: rgba(0, 0, 0, 0.7); padding: 10px; border-radius: 5px; width: 300px; }
  </style>
</head>
<body>
  <div id="info"></div>
  <div id="data-panel"></div>
  <div id="hso-panel"></div>
  <div id="events-panel"></div>
  <input type="range" id="timeline" min="0" max="4" step="1" value="0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    let scene, camera, renderer, earth, probes = [], orbits = [];
    const stages = [
  { 
    name: "Launch", 
    date: "2007-02-17", 
    probePositions: [
      { x: 0, y: 0, z: 0 }, // Placeholder positions for all probes
      { x: 0, y: 0, z: 0 },
      { x: 0, y: 0, z: 0 },
      { x: 0, y: 0, z: 0 },
      { x: 0, y: 0, z: 0 }
    ],
    hsoMissions: "THEMIS probes launched to study magnetospheric substorms.",
    events: "Launch of THEMIS probes."
  },
  { 
    name: "Orbit Placement Phase", 
    date: "2007-09-15", 
    probePositions: [
      { x: 30, y: 0, z: 0 }, // Probe 1 at 30 Re
      { x: 20, y: 0, z: 0 }, // Probe 2 at 20 Re
      { x: 12, y: 0, z: 0 }, // Probes 3 and 4 at 12 Re
      { x: 12, y: 0, z: 0 },
      { x: 10, y: 0, z: 0 }  // Probe 5 at 10 Re
    ],
    hsoMissions: "Coordinated studies with Cluster and GOES missions.",
    events: "Probes placed in their respective orbits."
  },
  { 
    name: "Tail Science Phase", 
    date: "2007-12-15", 
    probePositions: [
      { x: -30, y: 0, z: 0 }, // Probe 1 at -30 Re (magnetotail)
      { x: -20, y: 0, z: 0 }, // Probe 2 at -20 Re (magnetotail)
      { x: -12, y: 0, z: 0 }, // Probes 3 and 4 at -12 Re (magnetotail)
      { x: -12, y: 0, z: 0 },
      { x: -10, y: 0, z: 0 }  // Probe 5 at -10 Re (magnetotail)
    ],
    hsoMissions: "Coordinated studies with Geotail and Cluster missions.",
    events: "Observation of magnetic reconnection and energy dissipation in the magnetotail."
  },
  { 
    name: "Radiation Belt Science Phase", 
    date: "2008-04-15", 
    probePositions: [
      { x: 30, y: 0, z: 0 }, // Probe 1 at 30 Re (dusk side)
      { x: 20, y: 0, z: 0 }, // Probe 2 at 20 Re (dusk side)
      { x: 12, y: 0, z: 0 }, // Probes 3 and 4 at 12 Re (dusk side)
      { x: 12, y: 0, z: 0 },
      { x: 10, y: 0, z: 0 }  // Probe 5 at 10 Re (dusk side)
    ],
    hsoMissions: "Coordinated studies with Van Allen Probes and GOES missions.",
    events: "Study of radiation belt dynamics and particle acceleration."
  },
  { 
    name: "Dayside Science Phase", 
    date: "2008-06-15", 
    probePositions: [
      { x: 0, y: 30, z: 0 }, // Probe 1 at 30 Re (dayside)
      { x: 0, y: 20, z: 0 }, // Probe 2 at 20 Re (dayside)
      { x: 0, y: 12, z: 0 }, // Probes 3 and 4 at 12 Re (dayside)
      { x: 0, y: 12, z: 0 },
      { x: 0, y: 10, z: 0 }  // Probe 5 at 10 Re (dayside)
    ],
    hsoMissions: "Coordinated studies with Cluster and GOES missions.",
    events: "Observation of dayside reconnection and solar wind-magnetosphere interaction."
  },
];

    function init() {
      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Create Earth
      const earthGeometry = new THREE.SphereGeometry(1, 64, 64);
      const earthTexture = new THREE.TextureLoader().load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/land_ocean_ice_cloud_2048.jpg');
      const earthMaterial = new THREE.MeshBasicMaterial({ map: earthTexture });
      earth = new THREE.Mesh(earthGeometry, earthMaterial);
      scene.add(earth);

      // Create probes
      const probeGeometry = new THREE.SphereGeometry(0.05, 32, 32);
      const probeMaterials = [
        new THREE.MeshBasicMaterial({ color: 0xff0000 }),
        new THREE.MeshBasicMaterial({ color: 0x00ff00 }),
        new THREE.MeshBasicMaterial({ color: 0x0000ff }),
        new THREE.MeshBasicMaterial({ color: 0xffff00 }),
        new THREE.MeshBasicMaterial({ color: 0xff00ff }),
      ];
      for (let i = 0; i < 5; i++) {
        const probe = new THREE.Mesh(probeGeometry, probeMaterials[i]);
        probes.push(probe);
        scene.add(probe);
      }

      // Create orbits
      const orbitMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.5 });
      for (let i = 0; i < 5; i++) {
        const orbitGeometry = new THREE.BufferGeometry();
        const orbitPositions = new Float32Array(360 * 3);
        orbitGeometry.setAttribute('position', new THREE.BufferAttribute(orbitPositions, 3));
        const orbit = new THREE.Line(orbitGeometry, orbitMaterial);
        orbits.push(orbit);
        scene.add(orbit);
      }

      camera.position.set(0, 5, 10);
      camera.lookAt(0, 0, 0);

      const timeline = document.getElementById('timeline');
      timeline.addEventListener('input', updateStage);

      updateStage();
      animate();
    }

    function updateStage() {
      const stageIndex = parseInt(document.getElementById('timeline').value);
      const stage = stages[stageIndex];
      
      // Update probe positions based on stage data
      for (let i = 0; i < 5; i++) {
        const position = stage.probePositions[i];
        probes[i].position.set(position.x, position.y, position.z);
      }

      // Update orbit paths
      for (let i = 0; i < 5; i++) {
        const orbitPositions = orbits[i].geometry.attributes.position.array;
        for (let j = 0; j < 360; j++) {
          const angle = j * Math.PI / 180;
          const radius = 2 + i * 0.5;
          orbitPositions[j * 3] = radius * Math.cos(angle);
          orbitPositions[j * 3 + 1] = 0;
          orbitPositions[j * 3 + 2] = radius * Math.sin(angle);
        }
        orbits[i].geometry.attributes.position.needsUpdate = true;
      }

      // Update info panel
      document.getElementById('info').innerHTML = `
        <h2>Stage ${stageIndex + 1}: ${stage.name}</h2>
        <p>Date: ${stage.date}</p>
      `;

      // Update data panel
      document.getElementById('data-panel').innerHTML = `
        <h3>Probe Positions</h3>
        <table>
          <tr><th>Probe</th><th>X</th><th>Y</th><th>Z</th></tr>
          ${stage.probePositions.map((pos, i) => `
            <tr>
              <td>Probe ${i + 1}</td>
              <td>${pos.x.toFixed(2)}</td>
              <td>${pos.y.toFixed(2)}</td>
              <td>${pos.z.toFixed(2)}</td>
            </tr>
          `).join('')}
        </table>
      `;

      // Update HSO missions panel
      document.getElementById('hso-panel').innerHTML = `
        <h3>Coordinated HSO Missions</h3>
        <p>${stage.hsoMissions}</p>
      `;

      // Update events panel
      document.getElementById('events-panel').innerHTML = `
        <h3>Key Events</h3>
        <p>${stage.events}</p>
      `;
    }

    function animate() {
      requestAnimationFrame(animate);
      
      // Rotate Earth
      earth.rotation.y += 0.002;

      // Animate probes
      for (let i = 0; i < 5; i++) {
        const probe = probes[i];
        probe.position.x = probe.position.x * Math.cos(0.01) - probe.position.z * Math.sin(0.01);
        probe.position.z = probe.position.z * Math.cos(0.01) + probe.position.x * Math.sin(0.01);
      }

      renderer.render(scene, camera);
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    window.addEventListener('resize', onWindowResize, false);

    init();
  </script>
</body>
</html>